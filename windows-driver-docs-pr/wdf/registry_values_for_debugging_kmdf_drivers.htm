<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="This topic describes the registry values that a Windows Driver Frameworks (WDF) driver can set. It applies to Kernel-Mode Driver Framework (KMDF) drivers and User-Mode Driver Framework (UMDF) drivers starting with UMDF version 2."/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>Registry Values for Debugging WDF Drivers (KMDF and UMDF)</title>

<meta name="MS-HAID" content="Ch0_DFArchOverview_f0c4fc85-28a9-4de4-b37e-0c8061319861.xml"/>
<meta name="MS-HAID" content="kmdf.registry_values_for_debugging_framework_based_drivers"/>
<meta name="MS-HAID" content="kmdf.registry_values_for_debugging_kmdf_drivers"/>
<meta name="MS-HAID" content="wdf.registry_values_for_debugging_kmdf_drivers"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="wdf.registry_values_for_debugging_kmdf_drivers"></a>Registry Values for Debugging WDF Drivers (KMDF and UMDF)</h1>
</div>
<p>This topic describes the registry values that a Windows Driver Frameworks (WDF) driver can set. It applies to Kernel-Mode Driver Framework (KMDF) drivers and User-Mode Driver Framework (UMDF) drivers starting with UMDF version 2.</p>
<p>The following registry values can exist under a driver's <b>Parameters\Wdf</b> subkey. For a KMDF driver, this subkey is located in <b>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services</b>, under the driver's service name. For a UMDF driver, this subkey is located in <b>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WUDF\Services</b>, under the driver's service name. The subkey for the driver always uses the driver's service name, even if the driver binary's file name differs from the service name.</p>
<p></p>
<dl>
<dt><a id="VerifierOn_________________REG_DWORD_"></a><a id="verifieron_________________reg_dword_"></a><a id="VERIFIERON_________________REG_DWORD_"></a><b>VerifierOn</b>
               (<b>REG_DWORD</b>)</dt>
<dd>
<p>Set to a nonzero value to enable <a href="using_kmdf_verifier.htm">KMDF Verifier</a>, which extensively validates a driver's state and function parameters. You should set <b>VerifierOn</b> and <b>DbgBreakOnError</b> when you are developing your driver.</p>
</dd>
<dt><a id="VerifyOn_________________REG_DWORD_"></a><a id="verifyon_________________reg_dword_"></a><a id="VERIFYON_________________REG_DWORD_"></a><b>VerifyOn</b>
               (<b>REG_DWORD</b>)</dt>
<dd>
<p>Set to a nonzero value to enable the <a href="wdf.wdfverify"><b>WDFVERIFY</b></a> macro that is defined in Wdfassert.h, or set to zero to disable the macro. If the VerifyOn value is set, VerifyOn is implicitly set to nonzero.</p>
</dd>
<dt><a id="DbgBreakOnError__REG_DWORD_"></a><a id="dbgbreakonerror__reg_dword_"></a><a id="DBGBREAKONERROR__REG_DWORD_"></a><b>DbgBreakOnError</b> (<b>REG_DWORD</b>)</dt>
<dd>
<p>If set to a nonzero value, the framework breaks into the debugger when a driver calls <a href="wdf.wdfverifierdbgbreakpoint"><b>WdfVerifierDbgBreakPoint</b></a>. (If the <b>VerifierOn</b> value is set, the framework breaks into the debugger even if the <b>DbgBreakOnError</b> value does not exist.)</p>
</dd>
<dt><a id="DbgWaitForSignalTimeoutInSec__REG_DWORD_"></a><a id="dbgwaitforsignaltimeoutinsec__reg_dword_"></a><a id="DBGWAITFORSIGNALTIMEOUTINSEC__REG_DWORD_"></a><b>DbgWaitForSignalTimeoutInSec</b> (<b>REG_DWORD</b>)</dt>
<dd>
<p>Starting in Windows 8, when <b>VerifierOn</b> and <b>DbgBreakOnError</b> are set to nonzero values, the driver can change the default timeout period for breaking into the debugger by setting <b>DbgWaitForSignalTimeoutInSec</b>.</p>
<p>This value is available in framework versions 1.11 and later.</p>
</dd>
<dt><a id="VerifierAllocateFailCount_________________REG_DWORD_"></a><a id="verifierallocatefailcount_________________reg_dword_"></a><a id="VERIFIERALLOCATEFAILCOUNT_________________REG_DWORD_"></a><b>VerifierAllocateFailCount</b>
               (<b>REG_DWORD</b>)</dt>
<dd>
<p>If set to a value <i>n</i>, and if <b>VerifierOn</b> is set, the framework fails every attempt to allocate memory for the driver's objects after the <i>nth</i> allocation. This failure helps you test your driver's handling of low-memory conditions. For example, if you set <b>VerifierAllocateFailCount</b> to 2, every memory allocation after the second allocation will fail. The default value for <b>VerifierAllocateFailCount</b> is 0xffffffff. After setting <b>VerifierAllocateFailCount</b>, you can turn it off by setting it to (DWORD) -1 or removing the value altogether.</p>
<p>Note that the verifier counts both the allocations that your driver requests and the allocations that the framework requests on behalf of your driver. Also note that the number of allocations that might occur for your driver can change from one release of the framework to the next.</p>
</dd>
<dt><a id="TrackHandles__REG_MULTI_SZ_"></a><a id="trackhandles__reg_multi_sz_"></a><a id="TRACKHANDLES__REG_MULTI_SZ_"></a><b>TrackHandles</b> (<b>REG_MULTI_SZ</b>)</dt>
<dd>
<p>If set to a list of one or more type names of framework object handles, and if <b>VerifierOn</b> is set, the framework tracks references to all object handles that match the specified handle types. For example, if the handle type list consists of the "WDFREQUEST WDFQUEUE" string, the framework tracks references to all request objects and queue objects. If the list contains an asterisk ("*"), the framework tracks all object handles.</p>
</dd>
<dt><a id="VerboseOn_________________REG_DWORD_"></a><a id="verboseon_________________reg_dword_"></a><a id="VERBOSEON_________________REG_DWORD_"></a><b>VerboseOn</b>
               (<b>REG_DWORD</b>)</dt>
<dd>
<p>If set to a nonzero value, the framework's <a href="using_the_framework_s_event_logger.htm">event logger</a> records additional information that can help you debug your driver, such as entries into or exits from internal code paths. You should set this value only while you are developing your driver.</p>
</dd>
<dt><a id="LogPages__REG_DWORD_"></a><a id="logpages__reg_dword_"></a><a id="LOGPAGES__REG_DWORD_"></a><b>LogPages</b> (<b>REG_DWORD</b>)</dt>
<dd>
<p>Set to the number of memory pages that the framework assigns to its event logger. If the value is undefined, the framework uses a default value of one page. The maximum value that you can set is 16 for computers that have 4-kilobyte-sized memory pages (x86 and amd64 processors) and 8 for computers that have 8-kilobyte-sized memory pages (ia64 processors). (The operating system might not write the log contents to a crash dump file if a large number of pages is specified.)</p>
</dd>
<dt><a id="ForceLogsInMiniDump__REG_DWORD_"></a><a id="forcelogsinminidump__reg_dword_"></a><a id="FORCELOGSINMINIDUMP__REG_DWORD_"></a><b>ForceLogsInMiniDump</b> (<b>REG_DWORD</b>)</dt>
<dd>
<p>Set to a nonzero value to cause the framework to include information from its event logger in crash dump files. </p>
</dd>
<dt><a id="TraceDelayTime__REG_DWORD_"></a><a id="tracedelaytime__reg_dword_"></a><a id="TRACEDELAYTIME__REG_DWORD_"></a><b>TraceDelayTime</b> (<b>REG_DWORD</b>)</dt>
<dd>
<p>For Microsoft Windows 2000 only, set to a nonzero value to introduce a delay during initialization of <a href="devtest.wpp_software_tracing">WPP software tracing</a>. The value is specified in milliseconds and a useful value is 1000 (1 second). Without this delay, the first part of the WPP trace might be missed. </p>
</dd>
<dt><a id="EnhancedVerifierOptions_________________REG_DWORD_"></a><a id="enhancedverifieroptions_________________reg_dword_"></a><a id="ENHANCEDVERIFIEROPTIONS_________________REG_DWORD_"></a><b>EnhancedVerifierOptions</b>
               (<b>REG_DWORD</b>)</dt>
<dd>
<p>This value contains a bitmap. Each bit represents an additional verifier option that users can enable by setting the bit. </p>
<p><i>Bit values:</i></p>
<p><b>0x1</b>: If set, the verifier checks whether each of the driver's event callback functions does the following:</p>
<ul>
<li>
<p>Returns at the same IRQL at which it was called. If the values are different, a <a href="debugger.bug_check_0x10d___wdf_violation"><b>WDF_VIOLATION</b></a> bug check occurs with an error code of 0xE.</p>
</li>
<li>
<p>Before returning, exits all <a href="kernel.critical_regions_and_guarded_regions">critical regions</a> that it enters. If the callback function returns within a critical region that it entered, a <a href="debugger.bug_check_0x10d___wdf_violation"><b>WDF_VIOLATION</b></a> bug check occurs with an error code of 0xF.</p>
</li>
</ul>
<p><b>0x10000</b>: If set, and if the driver has enabled <a href="guaranteeing_forward_progress_of_i_o_operations.htm">guaranteed forward progress</a> for an I/O queue, the framework simulates a low-memory situation for each of the queue's I/O requests.</p>
<p><b>0x20000</b>: If set, and if the driver has enabled guaranteed forward progress for an I/O queue, the framework simulates a low-memory situation for some randomly selected I/O requests. </p>
<p>This value is available in framework versions 1.9 and later.</p>
</dd>
<dt><a id="VerifyDownLevel__REG_DWORD_"></a><a id="verifydownlevel__reg_dword_"></a><a id="VERIFYDOWNLEVEL__REG_DWORD_"></a><b>VerifyDownLevel</b> (<b>REG_DWORD</b>)</dt>
<dd>
<p>If set to a nonzero value, and if the driver was built with a version of the framework that is older than the current version, the framework's verifier includes tests that were added after the driver was built. If this value does not exist or is set to zero, the framework's verifier includes only the tests that existed when the driver was built.</p>
<p>For example, if your driver was built with version 1.7 of the framework, and if version 1.9 of the framework is installed on the computer, setting <b>VerifyDownLevel</b> to nonzero causes the verifier to include tests that were added to version 1.9 of the verifier when your driver runs.</p>
<p>This value is available in framework versions 1.9 and later.</p>
</dd>
</dl>
<h2><a id="KMDF"></a><a id="kmdf"></a>KMDF</h2>
<p>For a KMDF driver, the following registry value can exist under the <b>HKLM\SYSTEM\CurrentControlSet\Control\Wdf\Kmdf\Diagnostics</b> registry key. For a UMDF driver, the following registry value can exist under the <b>HKLM\System\CurrentControlSet\Control\Wdf\Umdf\Diagnostics</b> registry key. The driver might need to create the optional <b>Diagnostics</b> subkey.</p>
<p></p>
<dl>
<dt><a id="DbgPrintOn__REG_DWORD_"></a><a id="dbgprinton__reg_dword_"></a><a id="DBGPRINTON__REG_DWORD_"></a><b>DbgPrintOn</b> (<b>REG_DWORD</b>)</dt>
<dd>
<p>If set to a nonzero value, the framework's loader sends a variety of messages to the kernel debugger while it is loading a driver and binding it to a version of the framework library, or while it is unloading a driver.</p>
</dd>
</dl>
<h2><a id="UMDF"></a><a id="umdf"></a>UMDF</h2>
<p>You can also set the following registry values in <b>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WUDF\Services\{193a1820-d9ac-4997-8c55-be817523f6aa}</b>. These values affect all UMDF drivers on the system.</p>
<p></p>
<dl>
<dt><a id="HostProcessDbgBreakOnStart__REG_DWORD_"></a><a id="hostprocessdbgbreakonstart__reg_dword_"></a><a id="HOSTPROCESSDBGBREAKONSTART__REG_DWORD_"></a><b><b>HostProcessDbgBreakOnStart</b></b> (<b>REG_DWORD</b>)</dt>
<dd>
<p>Contains a delay value in seconds. During the specified delay period, the host process looks for the user-mode debugger once a second and breaks in if one is connected. If a user-mode debugger is not attached within this period and the high bit in <b>HostProcessDbgBreakOnStart</b> is set (0x80000000), the framework makes a single attempt to break into the kernel-mode debugger. For example:</p>
<table>
<tr>
<td>Value</td>
<td>Result</td>
</tr>
<tr>
<td>0x00000004</td>
<td>The framework attempts to connect to the user-mode debugger once a second for 4 seconds. The framework never tries to connect to the kernel-mode debugger.</td>
</tr>
<tr>
<td>0x80000000</td>
<td>The framework makes a single attempt to connect to the user-mode debugger. If the user-mode debugger is not attached, the framework tries to connect to the kernel-mode debugger. </td>
</tr>
<tr>
<td>0x80000004</td>
<td>The framework attempts to connect to the user-mode debugger once a second for 4 seconds. If the user-mode debugger is not attached within 4 seconds, the framework tries to connect to the kernel-mode debugger. </td>
</tr>
</table>
<p> </p>
</dd>
<dt><a id="HostProcessDbgBreakOnDriverLoad__REG_DWORD_"></a><a id="hostprocessdbgbreakondriverload__reg_dword_"></a><a id="HOSTPROCESSDBGBREAKONDRIVERLOAD__REG_DWORD_"></a><b><b>HostProcessDbgBreakOnDriverLoad</b></b> (<b>REG_DWORD</b>)</dt>
<dd>
<p>Contains a delay value in seconds. Causes WUDFHost to delay the specified number of seconds after the driver has been loaded. The behavior for <b>HostProcessDbgBreakOnDriverLoad</b> is otherwise the same as that described for <b>HostProcessDbgBreakOnStart</b>.</p>
</dd>
</dl>
<p>Specifying <b>HostProcessDbgBreakOnStart</b>  or <b>HostProcessDbgBreakOnDriverLoad</b> causes the framework to disable other UMDF timeouts (for example, Plug and Play operations).  This means that if your driver causes excessive timeouts, using these values might result in your driver causing a fatal crash on the target.</p>
<p>You can also set these registry values by using the WDF Verifier tool (WdfVerifier.exe) that is included in the WDK. For information on using this tool with UMDF drivers, see <a href="devtest.managing_umdf_verifier_settings_with_wdf_verifier">Managing UMDF Verifier Settings with WDF Verifier</a>.</p>
<p>These additional values are located in <b>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WUDF\DebugMode</b>:</p>
<p></p>
<dl>
<dt><a id="DebugModeFlags__REG_DWORD_"></a><a id="debugmodeflags__reg_dword_"></a><a id="DEBUGMODEFLAGS__REG_DWORD_"></a><b>DebugModeFlags</b> (<b>REG_DWORD</b>)</dt>
<dd>
<table>
<tr>
<th>
       Value</th>
<th>
       Description</th>
</tr>
<tr>
<td>
<p>0x01</p>
</td>
<td>
<p>Enable debug mode. This setting turns off the automatic restart functionality described in <a href="using_device_pooling_in_umdf_drivers.htm">Using Device Pooling in UMDF Drivers</a>.</p>
</td>
</tr>
<tr>
<td>
<p>0x02</p>
</td>
<td>
<p>Disable device pooling. For more information about device pooling, see <a href="using_device_pooling_in_umdf_drivers.htm">Using Device Pooling in UMDF Drivers</a>.</p>
</td>
</tr>
<tr>
<td>
<p>0x04</p>
</td>
<td>
<p>Disable timeouts.</p>
</td>
</tr>
</table>
<p> </p>
<p> When you use the F5 option in Microsoft Visual Studio, all three flags are set for the deployed driver.</p>
</dd>
<dt><a id="DebugModeBinaries__REG_SZ_"></a><a id="debugmodebinaries__reg_sz_"></a><a id="DEBUGMODEBINARIES__REG_SZ_"></a><b>DebugModeBinaries</b> (<b>REG_SZ</b>)</dt>
<dd>
<p>This value specifies the names of the driver binaries to be loaded in debug mode.  To enable debug mode for driver binaries X.DLL, Y.DLL and Z.DLL, for example, this value would be set to <i>X.DLL\0Y.DLL\0Z.DLL\0\0</i>.
</p>
</dd>
</dl>
<p>You can also set the following value in <b>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WUDF</b>:</p>
<p></p>
<dl>
<dt><a id="HostFailKdDebugBreak__REG_DWORD_"></a><a id="hostfailkddebugbreak__reg_dword_"></a><a id="HOSTFAILKDDEBUGBREAK__REG_DWORD_"></a><b>HostFailKdDebugBreak</b> (<b>REG_DWORD</b>)</dt>
<dd>
<p>If this value is non-zero and a kernel debugger is connected to the machine, the reflector breaks into the kernel debugger before terminating the host process. <b>HostFailKdDebugBreak</b> is disabled by default in Windows 7 and earlier operating systems. Starting in Windows 8, <b>HostFailKdDebugBreak</b> is enabled by default.</p>
<p> The reflector also breaks into the kernel debugger if there is an unexpected termination of the host process (e.g. by a non-UMDF component or due to an unhandled exception). If there are multiple device stacks pooled in the host process that is being terminated, the reflector breaks into the debugger multiple times, once for each device stack loaded in the host process.</p>
</dd>
</dl>
<p>For changes to UMDF registry values to take effect, you must reboot the computer.</p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [wdf\wdf]:%20Registry Values for Debugging WDF Drivers (KMDF and UMDF)%20 RELEASE:%20(3/15/2016)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
