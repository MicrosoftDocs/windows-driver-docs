---
title: Handling PnP Events and Power Management Events in an Intermediate Driver
description: Handling PnP Events and Power Management Events in an Intermediate Driver
keywords:
- intermediate drivers WDK networking , events
- NDIS intermediate drivers WDK , events
- Plug and Play WDK networking , intermediate drivers
- power management WDK networking , intermediate drivers
ms.date: 04/20/2017
---

# Handling PnP Events and Power Management Events in an Intermediate Driver





An intermediate driver must be able to handle Plug and Play (PnP) events and power management events. Specifically:

-   An intermediate driver must set the NDIS\_MINIPORT\_ATTRIBUTES\_NO\_HALT\_ON\_SUSPEND flag in the **AttributeFlags** member of the [**NDIS\_MINIPORT\_ADAPTER\_REGISTRATION\_ATTRIBUTES**](/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_miniport_adapter_registration_attributes) structure that is passed to [**NdisMSetMiniportAttributes**](/windows-hardware/drivers/ddi/ndis/nf-ndis-ndismsetminiportattributes). For more information, see [Initializing as a Miniport](initializing-virtual-miniports.md).

-   The virtual miniport of an intermediate driver must handle OID\_PNP\_*Xxx* requests.

-   The protocol section of an intermediate driver should propagate appropriate OID\_PNP\_*Xxx* requests to the underlying miniport drivers. The virtual miniport of the intermediate driver should pass the underlying miniport driver's responses to these requests back to the protocol driver that originated the requests. The intermediate driver does not have to pass requests that are not required by design. For example, when there is not a one-to-one relationship between virtual miniports and underlying miniport adapters as in Load Balancing Failover (LBFO) applications.

-   The protocol portion of an intermediate driver must supply a [*ProtocolNetPnPEvent*](/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_net_pnp_event) function.

Intermediate driver protocol and miniport event handlers are not called in any particular order. Event handlers for intermediate drivers should be implemented accordingly.

This section includes the following topics:

[Initializing Intermediate Drivers to Handle PnP and Power Management Events](initializing-intermediate-drivers-to-handle-pnp-and-power-management-events.md)

[Handling OID\_PNP\_Xxx Queries and Sets](handling-oid-pnp-xxx-queries-and-sets.md)

[Implementing a ProtocolNetPnPEvent Handler in an Intermediate Driver](implementing-a-protocolnetpnpevent-handler-in-an-intermediate-driver.md)

[Handling a Set Power Request](handling-a-set-power-request.md)

 

