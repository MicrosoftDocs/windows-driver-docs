---
title: Per-process GPU Virtual Address Spaces
description: Each process is associated with two graphics processing unit (GPU) virtual address spaces, an application GPU virtual address space and a privileged virtual address space.
ms.date: 04/20/2017
---

# <span id="display.per-process_gpu_virtual_address_spaces"></span>Per-process GPU virtual address spaces


Each process is associated with two graphics processing unit (GPU) virtual address spaces, an application GPU virtual address space and a privileged virtual address space.

## <span id="Application_GPU_virtual_address_space"></span><span id="application_gpu_virtual_address_space"></span><span id="APPLICATION_GPU_VIRTUAL_ADDRESS_SPACE"></span>Application GPU virtual address space


The application GPU virtual address space is the address space that command buffers, generated by the user mode driver, execute within. This address space is managed by the user mode driver using services provided by the video memory manager. Before an allocation can be accessed by a GPU engine operating in the virtual mode, the user mode driver must assign a GPU virtual address range to the allocation. For regular allocations, this is done using the new [*MapGpuVirtualAddress*](/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_mapgpuvirtualaddresscb) service, exposed by the video memory manager. *MapGpuVirtualAddress* allows the user mode driver to either pick a specific address where it wants the allocation to be mapped or it can let the video memory manager pick an available GPU virtual address automatically. Drivers should generally let the video memory manager pick an address automatically but in some circumstances the driver may need more control. In linked display adapter configurations, *MapGpuVirtualAddress* can also be used to specify whether a mapping is to the instance of the allocation on the current GPU or on a peer GPU. *MapGpuVirtualAddress* queues a request to the video memory manager and returns to the user mode driver immediately while the request is processed. The request is queued on the device paging queue and the user mode driver must ensure it synchronizes against the returned device paging fence value. [*FreeGpuVirtualAddress*](/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_freegpuvirtualaddresscb) can be used to unmap an allocation and reclaim its GPU virtual address. All virtual addresses associated with an allocation are automatically freed when the allocation is destroyed so the user mode driver doesn't need to explicitly unmap it. The video memory manager provides two tile resources-specific services to the user mode driver. [*ReserveGpuVirtualAddress*](/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_reservegpuvirtualaddresscb) allows the user mode driver to reserve address space for a tile resource and [*UpdateGpuVirtualAddress*](/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_updategpuvirtualaddresscb) allows the user mode driver to map and unmap regions of the tile resources to specific tile pool pages. *ReserveGpuVirtualAddress* executes against the device paging queue, while *UpdateGpuVirtualAddress* executes in a special companion context running within the process' privileged address space.

## <span id="Process_privileged_virtual_address_space"></span><span id="process_privileged_virtual_address_space"></span><span id="PROCESS_PRIVILEGED_VIRTUAL_ADDRESS_SPACE"></span>Process privileged virtual address space


Processes using tile resources get a second virtual address space associated with them on the first call to [*ReserveGpuVirtualAddress*](/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_reservegpuvirtualaddresscb). This address space is used to update the page table of the process synchronously with rendering. We cover this address space in the [Tile resources](tile-resources.md) topic.

## <span id="Virtual_address_space_on_linked_display_adapters"></span><span id="virtual_address_space_on_linked_display_adapters"></span><span id="VIRTUAL_ADDRESS_SPACE_ON_LINKED_DISPLAY_ADAPTERS"></span>Virtual address space on linked display adapters


When physical graphics adapters are linked to a linked display adapter chain, there is still a single GPU virtual address space per process (except the paging process). But the virtual address space on each physical adapter is mapped by its own set of page tables.

 

