---
title: Authenticated Key Exchange
description: Authenticated Key Exchange
ms.assetid: cd8c29ab-6276-4236-9b9c-152adf2868c3
keywords:
- authenticated key exchange WDK COPP
- key exchange WDK COPP
ms.date: 04/20/2017
ms.localizationpriority: medium
---

# Authenticated Key Exchange


## <span id="ddk_authenticated_key_exchange_gg"></span><span id="DDK_AUTHENTICATED_KEY_EXCHANGE_GG"></span>


This section applies only to Windows Server 2003 SP1 and later, and Windows XP SP2 and later.

The following figure shows establishing a secure connection through authentication and key exchange. First, the video miniport driver supplies the graphics hardware certificate to the application. Next, the application extracts the public key from the graphics hardware certificate. After the application generates a data integrity key (k<sub>DI</sub>), the application uses the public key to encrypt a sequence that includes the data integrity key and supplies the sequence to the driver.

Command and status messages are subsequently passed unencrypted; however, for each message, MACs are created by using the data integrity key.

![diagram illustrating authentication and key exchange](images/coppkey.png)

For more information about MACs, see [Cryptographic Primitives Used by COPP](cryptographic-primitives-used-by-copp.md).

The following table describes the values in the preceding figure.

<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><p>r<sub>GH</sub></p></td>
<td align="left"><p>128-bit random number generated by the driver.</p></td>
</tr>
<tr class="even">
<td align="left"><p>Cert<sub>GH</sub></p></td>
<td align="left"><p>Variable-length digital certificate used by the graphics hardware.</p></td>
</tr>
<tr class="odd">
<td align="left"><p>P<sub>GH</sub>(r<sub>GH</sub>, k<sub>DI</sub>, status_start, command_start)</p></td>
<td align="left"><p>Start sequence for the secure channel, which consists of the following items concatenated together:</p>
<ul>
<li><p>128-bit random number generated by the driver.</p></li>
<li><p>128-bit random data integrity session key generated by the application.</p></li>
<li><p>32-bit random starting status sequence number generated by the application.</p></li>
<li><p>32-bit random starting command sequence number generated by the application.</p></li>
</ul>
<p>The application encrypts the sequence by using the public key obtained from the graphic hardware certificate. The sequence is 2,048 bits long; the remainder of the sequence is padded with 0s.</p></td>
</tr>
</tbody>
</table>

 

 

 





