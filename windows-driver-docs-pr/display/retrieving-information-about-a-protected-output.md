---
title: Retrieving Information About a Protected Output
description: Retrieving Information About a Protected Output
ms.assetid: 20e268b8-fea0-48dd-a3cd-3cbb4233ef99
keywords:
- OPM WDK display , retrieving protected output information
ms.date: 04/20/2017
ms.localizationpriority: medium
---

# Retrieving Information About a Protected Output


The display miniport driver can receive requests to retrieve information about the protected output that is associated with a graphics adapter's physical output connector. The display miniport driver's [**DxgkDdiOPMGetInformation**](https://msdn.microsoft.com/library/windows/hardware/ff559725) function is passed a pointer to a [**DXGKMDT\_OPM\_GET\_INFO\_PARAMETERS**](https://msdn.microsoft.com/library/windows/hardware/ff560868) structure in the *Parameters* parameter that contains the information request. *DxgkDdiOPMGetInformation* writes the required information to the [**DXGKMDT\_OPM\_REQUESTED\_INFORMATION**](https://msdn.microsoft.com/library/windows/hardware/ff560910) structure that the *RequestedInformation* parameter points to. The **guidInformation** and **abParameters** members of DXGKMDT\_OPM\_GET\_INFO\_PARAMETERS specify the information request. Depending on the information request, the display miniport driver should populate the members of the [**DXGKMDT\_OPM\_STANDARD\_INFORMATION**](https://msdn.microsoft.com/library/windows/hardware/ff560925), [**DXGKMDT\_OPM\_OUTPUT\_ID**](https://msdn.microsoft.com/library/windows/hardware/ff560890), or [**DXGKMDT\_OPM\_ACTUAL\_OUTPUT\_FORMAT**](https://msdn.microsoft.com/library/windows/hardware/ff560840) structure with the required information and point the **abRequestedInformation** member of DXGKMDT\_OPM\_REQUESTED\_INFORMATION to that structure. After the driver specifies the **cbRequestedInformationSize** (for example, sizeof (DXGKMDT\_OPM\_STANDARD\_INFORMATION)) and **abRequestedInformation** members of DXGKMDT\_OPM\_REQUESTED\_INFORMATION, the driver must calculate the One-key Cipher Block Chaining (CBC)-mode message authentication code (OMAC) for the data in DXGKMDT\_OPM\_REQUESTED\_INFORMATION and must set this OMAC in the **omac** member of DXGKMDT\_OPM\_REQUESTED\_INFORMATION. For more information about calculating OMAC, see the [OMAC-1 algorithm](http://go.microsoft.com/fwlink/p/?linkid=70417).

**Note**   Before [**DxgkDdiOPMGetInformation**](https://msdn.microsoft.com/library/windows/hardware/ff559725) returns, the display miniport driver must verify that the OMAC that is specified in the **omac** member of [**DXGKMDT\_OPM\_GET\_INFO\_PARAMETERS**](https://msdn.microsoft.com/library/windows/hardware/ff560868) is correct. The driver must also verify that the sequence number that is specified in the **ulSequenceNumber** member of DXGKMDT\_OPM\_GET\_INFO\_PARAMETERS matches the sequence number that the driver currently has stored. The driver must then increment the stored sequence number.

 

**Note**   The driver must return a 128-bit cryptographically secure random number in the **rnRandomNumber** member of DXGKMDT\_OPM\_STANDARD\_INFORMATION, [**DXGKMDT\_OPM\_OUTPUT\_ID**](https://msdn.microsoft.com/library/windows/hardware/ff560890), or DXGKMDT\_OPM\_ACTUAL\_OUTPUT\_FORMAT. The random number was generated by the sending application and was provided in the **rnRandomNumber** member of DXGKMDT\_OPM\_GET\_INFO\_PARAMETERS.

 

The driver returns the following information for the indicated request:

-   For DXGKMDT\_OPM\_GET\_SUPPORTED\_PROTECTION\_TYPES set in the **guidInformation** member and undefined in the **abParameters** member of the DXGKMDT\_OPM\_GET\_INFO\_PARAMETERS structure, the driver indicates the available types of protection mechanisms. To indicate the available protection types, the driver returns a valid bitwise OR combination of values from the [**DXGKMDT\_OPM\_PROTECTION\_TYPE**](https://msdn.microsoft.com/library/windows/hardware/ff560898) enumeration in the **ulInformation** member of DXGKMDT\_OPM\_STANDARD\_INFORMATION. The DXGKMDT\_OPM\_PROTECTION\_TYPE\_HDCP and DXGKMDT\_OPM\_PROTECTION\_TYPE\_DPCP values are valid.

-   For DXGKMDT\_OPM\_GET\_CONNECTOR\_TYPE set in **guidInformation** and undefined in **abParameters**, the driver indicates the connector type. To indicate the connector type, the driver returns a valid bitwise OR combination of values from the [**D3DKMDT\_VIDEO\_OUTPUT\_TECHNOLOGY**](https://msdn.microsoft.com/library/windows/hardware/ff546605) enumeration in the **ulInformation** member of DXGKMDT\_OPM\_STANDARD\_INFORMATION.

-   For DXGKMDT\_OPM\_GET\_VIRTUAL\_PROTECTION\_LEVEL or DXGKMDT\_OPM\_GET\_ACTUAL\_PROTECTION\_LEVEL set in **guidInformation** and the protection type set in **abParameters**, the driver returns a protection-level value in the **ulInformation** member of [**DXGKMDT\_OPM\_STANDARD\_INFORMATION**](https://msdn.microsoft.com/library/windows/hardware/ff560925). If the protection type is DXGKMDT\_OPM\_PROTECTION\_TYPE\_HDCP, the protection-level value is from the [**DXGKMDT\_OPM\_HDCP\_PROTECTION\_LEVEL**](https://msdn.microsoft.com/library/windows/hardware/ff560878) enumeration. If the protection type is DXGKMDT\_OPM\_PROTECTION\_TYPE\_DPCP, the protection-level value is from the [**DXGKMDT\_OPM\_DPCP\_PROTECTION\_LEVEL**](https://msdn.microsoft.com/library/windows/hardware/ff560861) enumeration.

    The DXGKMDT\_OPM\_GET\_VIRTUAL\_PROTECTION\_LEVEL request returns the currently set protection level for the protected output. The DXGKMDT\_OPM\_GET\_ACTUAL\_PROTECTION\_LEVEL request returns the currently set protection level for the physical connector that is associated with the protected output.

-   For DXGKMDT\_OPM\_GET\_ADAPTER\_BUS\_TYPE set in **guidInformation** and undefined in **abParameters**, the driver identifies the type and implementation of the bus that connects a graphics adapter to a mother board chipset's north bridge. To identify the type and implementation of the bus, the driver returns a valid bitwise OR combination of values from the [**DXGKMDT\_OPM\_BUS\_TYPE\_AND\_IMPLEMENTATION**](https://msdn.microsoft.com/library/windows/hardware/ff560841) enumeration in the **ulInformation** member of DXGKMDT\_OPM\_STANDARD\_INFORMATION.

-   For DXGKMDT\_OPM\_GET\_CURRENT\_HDCP\_SRM\_VERSION set in **guidInformation** and undefined in **abParameters**, the driver returns a value in the **ulInformation** member of [**DXGKMDT\_OPM\_STANDARD\_INFORMATION**](https://msdn.microsoft.com/library/windows/hardware/ff560925) that identifies the version number of the current High-bandwidth Digital Content Protection (HDCP) System Renewability Message (SRM) for the protected output. The least significant bits (bits 0 through 15) contain the SRM's version number in little-endian format. For more information about the SRM version number, see the [HDCP Specification Revision 1.1](http://go.microsoft.com/fwlink/p/?linkid=38728).

-   For DXGKMDT\_OPM\_GET\_ACTUAL\_OUTPUT\_FORMAT set in **guidInformation** and undefined in **abParameters**, the driver returns information in the members of [**DXGKMDT\_OPM\_ACTUAL\_OUTPUT\_FORMAT**](https://msdn.microsoft.com/library/windows/hardware/ff560840) that describe how the signal that goes through the physical connector that is associated with the protected output is formatted.

-   For DXGKMDT\_OPM\_GET\_OUTPUT\_ID set in **guidInformation** and undefined in **abParameters**, the driver returns information in the members of [**DXGKMDT\_OPM\_OUTPUT\_ID**](https://msdn.microsoft.com/library/windows/hardware/ff560890) that identifies the output connector.

-   For DXGKMDT\_OPM\_GET\_DVI\_CHARACTERISTICS set in the **guidInformation** member and undefined in the **abParameters** member of the DXGKMDT\_OPM\_GET\_INFO\_PARAMETERS structure, the driver indicates electrical characteristics of a Digital Video Interface (DVI) output connector. To indicate the DVI electrical characteristics, the driver returns one of the values from the [**DXGKDT\_OPM\_DVI\_CHARACTERISTICS**](https://msdn.microsoft.com/library/windows/hardware/ff560819) enumeration in the **ulInformation** member of [**DXGKMDT\_OPM\_STANDARD\_INFORMATION**](https://msdn.microsoft.com/library/windows/hardware/ff560925).

 

 





